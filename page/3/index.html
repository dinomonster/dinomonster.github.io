<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="google2043cde1f559beda.html" />










  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />





  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.0.1" />






<meta name="description" content="Life is made up of small pleasures.">
<meta property="og:type" content="website">
<meta property="og:title" content="Dino's blog">
<meta property="og:url" content="https://dinomonster.github.io/page/3/index.html">
<meta property="og:site_name" content="Dino's blog">
<meta property="og:description" content="Life is made up of small pleasures.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Dino's blog">
<meta name="twitter:description" content="Life is made up of small pleasures.">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"always"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://dinomonster.github.io/page/3/"/>

  <title> Dino's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Dino's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Life is made up of small pleasures</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/16/为过滤动态加入单选按钮/" itemprop="url">
                  为过滤动态加入单选按钮
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-16T19:22:28+08:00" content="2016-08-16">
              2016-08-16
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/16/为过滤动态加入单选按钮/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/16/为过滤动态加入单选按钮/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/16/为过滤动态加入单选按钮/" class="leancloud_visitors" data-flag-title="为过滤动态加入单选按钮">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x9879;&#x76EE;&#x4E0A;&#x505A;&#x7684;&#x4E00;&#x4E2A;&#x8FC7;&#x6EE4;&#x7B5B;&#x9009;&#x7684;&#xFF0C;&#x5148;&#x770B;&#x770B;&#x6548;&#x679C;&#x56FE;<br><img src="/2016/08/16/&#x4E3A;&#x8FC7;&#x6EE4;&#x52A8;&#x6001;&#x52A0;&#x5165;&#x5355;&#x9009;&#x6309;&#x94AE;/1.gif" alt="1"></p>
<p>&#x8FD9;&#x91CC;&#x7684;&#x6570;&#x636E;&#x90FD;&#x662F;&#x52A8;&#x6001;&#x5199;&#x5165;&#x7684;&#xFF0C;&#x5F39;&#x51FA;&#x7684;&#x7684;&#x662F;popupwindow&#xFF0C;&#x539F;&#x672C;&#x662F;&#x4FA7;&#x6ED1;&#x7684;&#x62BD;&#x5C49;&#x5E03;&#x5C40;&#xFF0C;&#x9886;&#x5BFC;&#x8981;&#x6539;&#x6210;&#x8FD9;&#x6837;&#x5B50;&#xFF0C;&#x53EA;&#x597D;&#x6539;&#x4E86;&#x3002;</p>
<h3 id="1-Android-Radiogroup&#x7684;&#x5751;"><a href="#1-Android-Radiogroup&#x7684;&#x5751;" class="headerlink" title="1.Android Radiogroup&#x7684;&#x5751;"></a>1.Android Radiogroup&#x7684;&#x5751;</h3><p>Android&#x539F;&#x751F;&#x7684;Radiogroup&#x662F;&#x4E0D;&#x652F;&#x6301;&#x6362;&#x884C;&#x7684;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x8981;&#x4E48;&#x4E00;&#x76F4;&#x7AD6;&#x7740;&#x8981;&#x4E48;&#x4E00;&#x76F4;&#x6A2A;&#x7740;&#xFF0C;&#x5982;&#x679C;&#x7528;&#x4E24;&#x7EC4;radiogroup&#x8FD8;&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;&#x4E92;&#x65A5;&#x7B97;&#x6CD5;&#xFF0C;&#x6BD4;&#x8F83;&#x9EBB;&#x70E6;&#x3002;<br>&#x6211;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;&#x81EA;&#x5B9A;&#x4E49;radiogroup&#xFF0C;&#x7EE7;&#x627F;&#x7CFB;&#x7EDF;&#x7684;RadioGroup&#x6765;&#x5B9E;&#x73B0;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x7EE7;&#x627F;LinearLayout&#xFF0C;&#x4E0D;&#x8FC7;&#x663E;&#x7136;&#x7B2C;&#x4E00;&#x79CD;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#x3002;</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.util.AttributeSet;</div><div class="line"><span class="keyword">import</span> android.util.Log;</div><div class="line"><span class="keyword">import</span> android.view.View;</div><div class="line"><span class="keyword">import</span> android.widget.RadioGroup;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * &#x91CD;&#x65B0;&#x5BF9;RadioGroup&#x8FDB;&#x884C;&#x5E03;&#x5C40;&#xFF0C;&#x53EF;&#x4EE5;&#x6298;&#x884C; </div><div class="line"> * &#x9ED8;&#x8BA4;&#x6C34;&#x5E73;&#x5F00;&#x59CB;&#x6392;&#x5E03; </div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RadioGroupEx</span> <span class="keyword">extends</span> <span class="title">RadioGroup</span> </span>{</div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = <span class="string">&quot;RadioGroupEx&quot;</span>;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RadioGroupEx</span><span class="params">(Context context)</span> </span>{</div><div class="line">        <span class="keyword">super</span>(context);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">RadioGroupEx</span><span class="params">(Context context, AttributeSet attrs)</span> </span>{</div><div class="line">        <span class="keyword">super</span>(context, attrs);</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onMeasure</span><span class="params">(<span class="keyword">int</span> widthMeasureSpec, <span class="keyword">int</span> heightMeasureSpec)</span> </span>{</div><div class="line">        <span class="keyword">int</span> widthSize = MeasureSpec.getSize(widthMeasureSpec);</div><div class="line">        <span class="keyword">int</span> widthMode = MeasureSpec.getMode(widthMeasureSpec);</div><div class="line">        <span class="keyword">int</span> heightSize = MeasureSpec.getSize(heightMeasureSpec);</div><div class="line">        <span class="keyword">int</span> heightMode = MeasureSpec.getMode(heightMeasureSpec);</div><div class="line"></div><div class="line">        <span class="comment">//&#x8C03;&#x7528;ViewGroup&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x6D4B;&#x91CF;&#x5B50;view  </span></div><div class="line">        measureChildren(widthMeasureSpec, heightMeasureSpec);</div><div class="line"></div><div class="line">        <span class="comment">//&#x6700;&#x5927;&#x7684;&#x5BBD;  </span></div><div class="line">        <span class="keyword">int</span> maxWidth = <span class="number">0</span>;</div><div class="line">        <span class="comment">//&#x7D2F;&#x8BA1;&#x7684;&#x9AD8;  </span></div><div class="line">        <span class="keyword">int</span> totalHeight = <span class="number">0</span>;</div><div class="line"></div><div class="line">        <span class="comment">//&#x5F53;&#x524D;&#x8FD9;&#x4E00;&#x884C;&#x7684;&#x7D2F;&#x8BA1;&#x884C;&#x5BBD;  </span></div><div class="line">        <span class="keyword">int</span> lineWidth = <span class="number">0</span>;</div><div class="line">        <span class="comment">//&#x5F53;&#x524D;&#x8FD9;&#x884C;&#x7684;&#x6700;&#x5927;&#x884C;&#x9AD8;  </span></div><div class="line">        <span class="keyword">int</span> maxLineHeight = <span class="number">0</span>;</div><div class="line">        <span class="comment">//&#x7528;&#x4E8E;&#x8BB0;&#x5F55;&#x6362;&#x884C;&#x524D;&#x7684;&#x884C;&#x5BBD;&#x548C;&#x884C;&#x9AD8;  </span></div><div class="line">        <span class="keyword">int</span> oldHeight;</div><div class="line">        <span class="keyword">int</span> oldWidth;</div><div class="line"></div><div class="line">        <span class="keyword">int</span> count = getChildCount();</div><div class="line">        <span class="comment">//&#x5047;&#x8BBE; widthMode&#x548C;heightMode&#x90FD;&#x662F;AT_MOST  </span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) {</div><div class="line">            View child = getChildAt(i);</div><div class="line">            MarginLayoutParams params = (MarginLayoutParams) child.getLayoutParams();</div><div class="line">            <span class="comment">//&#x5F97;&#x5230;&#x8FD9;&#x4E00;&#x884C;&#x7684;&#x6700;&#x9AD8;  </span></div><div class="line">            oldHeight = maxLineHeight;</div><div class="line">            <span class="comment">//&#x5F53;&#x524D;&#x6700;&#x5927;&#x5BBD;&#x5EA6;  </span></div><div class="line">            oldWidth = maxWidth;</div><div class="line"></div><div class="line">            <span class="keyword">int</span> deltaX = child.getMeasuredWidth() + params.leftMargin + params.rightMargin;</div><div class="line">            <span class="keyword">if</span> (lineWidth + deltaX + getPaddingLeft() + getPaddingRight() &gt; widthSize) {<span class="comment">//&#x5982;&#x679C;&#x6298;&#x884C;,height&#x589E;&#x52A0;  </span></div><div class="line">                <span class="comment">//&#x548C;&#x76EE;&#x524D;&#x6700;&#x5927;&#x7684;&#x5BBD;&#x5EA6;&#x6BD4;&#x8F83;,&#x5F97;&#x5230;&#x6700;&#x5BBD;&#x3002;&#x4E0D;&#x80FD;&#x52A0;&#x4E0A;&#x5F53;&#x524D;&#x7684;child&#x7684;&#x5BBD;,&#x6240;&#x4EE5;&#x7528;&#x7684;&#x662F;oldWidth  </span></div><div class="line">                maxWidth = Math.max(lineWidth, oldWidth);</div><div class="line">                <span class="comment">//&#x91CD;&#x7F6E;&#x5BBD;&#x5EA6;  </span></div><div class="line">                lineWidth = deltaX;</div><div class="line">                <span class="comment">//&#x7D2F;&#x52A0;&#x9AD8;&#x5EA6;  </span></div><div class="line">                totalHeight += oldHeight;</div><div class="line">                <span class="comment">//&#x91CD;&#x7F6E;&#x884C;&#x9AD8;,&#x5F53;&#x524D;&#x8FD9;&#x4E2A;View&#xFF0C;&#x5C5E;&#x4E8E;&#x4E0B;&#x4E00;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x5F53;&#x524D;&#x6700;&#x5927;&#x884C;&#x9AD8;&#x4E3A;&#x8FD9;&#x4E2A;child&#x7684;&#x9AD8;&#x5EA6;&#x52A0;&#x4E0A;margin  </span></div><div class="line">                maxLineHeight = child.getMeasuredHeight() + params.topMargin + params.bottomMargin;</div><div class="line">                Log.v(TAG, <span class="string">&quot;maxHeight:&quot;</span> + totalHeight + <span class="string">&quot;---&quot;</span> + <span class="string">&quot;maxWidth:&quot;</span> + maxWidth);</div><div class="line"></div><div class="line">            } <span class="keyword">else</span> {</div><div class="line">                <span class="comment">//&#x4E0D;&#x6362;&#x884C;&#xFF0C;&#x7D2F;&#x52A0;&#x5BBD;&#x5EA6;  </span></div><div class="line">                lineWidth += deltaX;</div><div class="line">                <span class="comment">//&#x4E0D;&#x6362;&#x884C;&#xFF0C;&#x8BA1;&#x7B97;&#x884C;&#x6700;&#x9AD8;  </span></div><div class="line">                <span class="keyword">int</span> deltaY = child.getMeasuredHeight() + params.topMargin + params.bottomMargin;</div><div class="line">                maxLineHeight = Math.max(maxLineHeight, deltaY);</div><div class="line">            }</div><div class="line">            <span class="keyword">if</span> (i == count - <span class="number">1</span>) {</div><div class="line">                <span class="comment">//&#x524D;&#x9762;&#x6CA1;&#x6709;&#x52A0;&#x4E0A;&#x4E0B;&#x4E00;&#x884C;&#x7684;&#x641E;&#xFF0C;&#x5982;&#x679C;&#x662F;&#x6700;&#x540E;&#x4E00;&#x884C;&#xFF0C;&#x8FD8;&#x8981;&#x518D;&#x53E0;&#x52A0;&#x4E0A;&#x6700;&#x540E;&#x4E00;&#x884C;&#x7684;&#x6700;&#x9AD8;&#x7684;&#x503C;  </span></div><div class="line">                totalHeight += maxLineHeight;</div><div class="line">                <span class="comment">//&#x8BA1;&#x7B97;&#x6700;&#x540E;&#x4E00;&#x884C;&#x548C;&#x524D;&#x9762;&#x7684;&#x6700;&#x5BBD;&#x7684;&#x4E00;&#x884C;&#x6BD4;&#x8F83;  </span></div><div class="line">                maxWidth = Math.max(lineWidth, oldWidth);</div><div class="line">            }</div><div class="line">        }</div><div class="line"></div><div class="line">        <span class="comment">//&#x52A0;&#x4E0A;&#x5F53;&#x524D;&#x5BB9;&#x5668;&#x7684;padding&#x503C;  </span></div><div class="line">        maxWidth += getPaddingLeft() + getPaddingRight();</div><div class="line">        totalHeight += getPaddingTop() + getPaddingBottom();</div><div class="line">        setMeasuredDimension(widthMode == MeasureSpec.EXACTLY ? widthSize : maxWidth,</div><div class="line">                heightMode == MeasureSpec.EXACTLY ? heightSize : totalHeight);</div><div class="line"></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onLayout</span><span class="params">(<span class="keyword">boolean</span> changed, <span class="keyword">int</span> l, <span class="keyword">int</span> t, <span class="keyword">int</span> r, <span class="keyword">int</span> b)</span> </span>{</div><div class="line">        <span class="keyword">int</span> count = getChildCount();</div><div class="line">        <span class="comment">//pre&#x4E3A;&#x524D;&#x9762;&#x6240;&#x6709;&#x7684;child&#x7684;&#x76F8;&#x52A0;&#x540E;&#x7684;&#x4F4D;&#x7F6E;  </span></div><div class="line">        <span class="keyword">int</span> preLeft = getPaddingLeft();</div><div class="line">        <span class="keyword">int</span> preTop = getPaddingTop();</div><div class="line">        <span class="comment">//&#x8BB0;&#x5F55;&#x6BCF;&#x4E00;&#x884C;&#x7684;&#x6700;&#x9AD8;&#x503C;  </span></div><div class="line">        <span class="keyword">int</span> maxHeight = <span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; count; i++) {</div><div class="line">            View child = getChildAt(i);</div><div class="line">            MarginLayoutParams params = (MarginLayoutParams) child.getLayoutParams();</div><div class="line">            <span class="comment">//r-l&#x4E3A;&#x5F53;&#x524D;&#x5BB9;&#x5668;&#x7684;&#x5BBD;&#x5EA6;&#x3002;&#x5982;&#x679C;&#x5B50;view&#x7684;&#x7D2F;&#x79EF;&#x5BBD;&#x5EA6;&#x5927;&#x4E8E;&#x5BB9;&#x5668;&#x5BBD;&#x5EA6;&#xFF0C;&#x5C31;&#x6362;&#x884C;&#x3002;  </span></div><div class="line">            <span class="keyword">if</span> (preLeft + params.leftMargin + child.getMeasuredWidth() + params.rightMargin + getPaddingRight() &gt; (r - l)) {</div><div class="line">                <span class="comment">//&#x91CD;&#x7F6E;  </span></div><div class="line">                preLeft = getPaddingLeft();</div><div class="line">                <span class="comment">//&#x8981;&#x9009;&#x62E9;child&#x7684;height&#x6700;&#x5927;&#x7684;&#x4F5C;&#x4E3A;&#x8BBE;&#x7F6E;  </span></div><div class="line">                preTop = preTop + maxHeight;</div><div class="line">                maxHeight = getChildAt(i).getMeasuredHeight() + params.topMargin + params.bottomMargin;</div><div class="line">            } <span class="keyword">else</span> { <span class="comment">//&#x4E0D;&#x6362;&#x884C;,&#x8BA1;&#x7B97;&#x6700;&#x5927;&#x9AD8;&#x5EA6;  </span></div><div class="line">                maxHeight = Math.max(maxHeight, child.getMeasuredHeight() + params.topMargin + params.bottomMargin);</div><div class="line">            }</div><div class="line">            <span class="comment">//left&#x5750;&#x6807;  </span></div><div class="line">            <span class="keyword">int</span> left = preLeft + params.leftMargin;</div><div class="line">            <span class="comment">//top&#x5750;&#x6807;  </span></div><div class="line">            <span class="keyword">int</span> top = preTop + params.topMargin;</div><div class="line">            <span class="keyword">int</span> right = left + child.getMeasuredWidth();</div><div class="line">            <span class="keyword">int</span> bottom = top + child.getMeasuredHeight();</div><div class="line">            <span class="comment">//&#x4E3A;&#x5B50;view&#x5E03;&#x5C40;  </span></div><div class="line">            child.layout(left, top, right, bottom);</div><div class="line">            <span class="comment">//&#x8BA1;&#x7B97;&#x5E03;&#x5C40;&#x7ED3;&#x675F;&#x540E;&#xFF0C;preLeft&#x7684;&#x503C;  </span></div><div class="line">            preLeft += params.leftMargin + child.getMeasuredWidth() + params.rightMargin;</div><div class="line"></div><div class="line">        }</div><div class="line"></div><div class="line">    }  }</div></pre></td></tr></table></figure>
<p>&#x5728;&#x5E03;&#x5C40;&#x4E2D;&#x7528;&#x8FD9;&#x4E2A;radiogroup&#x66FF;&#x4EE3;&#x539F;&#x751F;&#x7684;&#x65E2;&#x53EF;&#xFF0C;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x4E0D;&#x53D8;</p>
<h3 id="2-&#x5728;activity&#x4E2D;&#x52A0;&#x5165;popup&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x6DFB;&#x52A0;radiobutton&#x7684;&#x4EE3;&#x7801;"><a href="#2-&#x5728;activity&#x4E2D;&#x52A0;&#x5165;popup&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x6DFB;&#x52A0;radiobutton&#x7684;&#x4EE3;&#x7801;" class="headerlink" title="2.&#x5728;activity&#x4E2D;&#x52A0;&#x5165;popup&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x6DFB;&#x52A0;radiobutton&#x7684;&#x4EE3;&#x7801;"></a>2.&#x5728;activity&#x4E2D;&#x52A0;&#x5165;popup&#x4EE5;&#x53CA;&#x52A8;&#x6001;&#x6DFB;&#x52A0;radiobutton&#x7684;&#x4EE3;&#x7801;</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * &#x8FC7;&#x6EE4;&#x7684;popup</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String primaryUrl = <span class="string">&quot;www/js/primary_class_phase.json&quot;</span>;<span class="comment">//&#x5C0F;&#x5B66;</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String juniorUrl = <span class="string">&quot;www/js/junior_class_phase.json&quot;</span>;<span class="comment">//&#x521D;&#x4E2D;</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String seniorUrl = <span class="string">&quot;www/js/senior_class_phase.json&quot;</span>;<span class="comment">//&#x9AD8;&#x4E2D;</span></div><div class="line"></div><div class="line">    <span class="keyword">private</span> RadioGroupEx phaseRadio;<span class="comment">//&#x5B66;&#x6BB5;</span></div><div class="line">    <span class="keyword">private</span> RadioGroupEx gradeRadio;<span class="comment">//&#x5E74;&#x7EA7;</span></div><div class="line">    <span class="keyword">private</span> RadioGroupEx subjectRadio;<span class="comment">//&#x79D1;&#x76EE;</span></div><div class="line">    <span class="keyword">private</span> String[] phaseCode={<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;4&quot;</span>};</div><div class="line">    <span class="keyword">private</span> String[] gradeCode={<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;5&quot;</span>,<span class="string">&quot;7&quot;</span>,<span class="string">&quot;9&quot;</span>};</div><div class="line">    <span class="keyword">private</span> List&lt;String&gt; subjectCode=<span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">showPopupWindowFilter</span><span class="params">(View view)</span> </span>{</div><div class="line">        <span class="comment">// &#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x5E03;&#x5C40;&#xFF0C;&#x4F5C;&#x4E3A;&#x663E;&#x793A;&#x7684;&#x5185;&#x5BB9;</span></div><div class="line">        View contentView = LayoutInflater.from(<span class="keyword">this</span>).inflate(R.layout.openclass_filter_popup, <span class="keyword">null</span>);</div><div class="line">        phaseRadio = (RadioGroupEx) contentView.findViewById(R.id.openclass_radio_phase);</div><div class="line">        gradeRadio = (RadioGroupEx) contentView.findViewById(R.id.openclass_radio_grade);</div><div class="line">        subjectRadio = (RadioGroupEx) contentView.findViewById(R.id.openclass_radio_subject);</div><div class="line">        phaseRadio.setOrientation(LinearLayout.HORIZONTAL);</div><div class="line">        gradeRadio.setOrientation(LinearLayout.HORIZONTAL);</div><div class="line">        subjectRadio.setOrientation(LinearLayout.HORIZONTAL);</div><div class="line"></div><div class="line">        RadioGroup.OnCheckedChangeListener popupRadioCheckListener = <span class="keyword">new</span> RadioGroup.OnCheckedChangeListener() {</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCheckedChanged</span><span class="params">(RadioGroup group, <span class="keyword">int</span> checkedId)</span> </span>{</div><div class="line">                <span class="keyword">switch</span> (group.getId()){</div><div class="line">                    <span class="keyword">case</span> R.id.openclass_radio_phase:<span class="comment">//&#x5B66;&#x6BB5;</span></div><div class="line">                        phaseId = (String)group.findViewById(checkedId).getTag();</div><div class="line">                        mGradeId = <span class="string">&quot;&quot;</span>;</div><div class="line">                        subjectId = <span class="string">&quot;&quot;</span>;</div><div class="line">                        <span class="keyword">int</span> pid = Integer.parseInt(phaseId);</div><div class="line">                        createSubjectRadio(pid,subjectRadio);</div><div class="line">                        createGradeRadio(pid,gradeRadio);</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> R.id.openclass_radio_grade:<span class="comment">//&#x5E74;&#x7EA7;</span></div><div class="line">                        mGradeId = (String)group.findViewById(checkedId).getTag();</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> R.id.openclass_radio_subject:<span class="comment">//&#x79D1;&#x76EE;</span></div><div class="line">                        subjectId = (String)group.findViewById(checkedId).getTag();</div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                }</div><div class="line">                Log.d(TAG,<span class="string">&quot;phaseId:&quot;</span>+phaseId+<span class="string">&quot;mGradeId:&quot;</span>+mGradeId+<span class="string">&quot;subjectId:&quot;</span>+subjectId);</div><div class="line">                <span class="keyword">if</span>(!StringUtils.isEmpty(phaseId)&amp;&amp;!StringUtils.isEmpty(mGradeId)&amp;&amp;!StringUtils.isEmpty(subjectId)){</div><div class="line">                    <span class="keyword">int</span> currentItem = mViewPager.getCurrentItem();</div><div class="line">                    Fragment fragment = adapter.getPage(currentItem);</div><div class="line">                    <span class="keyword">if</span> (fragment <span class="keyword">instanceof</span> OpenclassUpdateFilter) {</div><div class="line">                        OpenclassUpdateFilter openclassUpdateFilter = (OpenclassUpdateFilter)fragment ;</div><div class="line">                        openclassUpdateFilter.updateData(phaseId,mGradeId,subjectId);</div><div class="line">                    }</div><div class="line">                }</div><div class="line"></div><div class="line">            }</div><div class="line">        };</div><div class="line"></div><div class="line">        phaseRadio.setOnCheckedChangeListener(popupRadioCheckListener);</div><div class="line">        gradeRadio.setOnCheckedChangeListener(popupRadioCheckListener);</div><div class="line">        subjectRadio.setOnCheckedChangeListener(popupRadioCheckListener);</div><div class="line">        createPhaseRadio(phaseRadio);</div><div class="line">        createGradeRadio(<span class="number">2</span>,gradeRadio);<span class="comment">//&#x521B;&#x5EFA;&#x5E74;&#x7EA7;&#x5355;&#x9009;&#xFF0C;&#x6839;&#x636E;&#x5B66;&#x6BB5;&#xFF0C;&#x9ED8;&#x8BA4;&#x5C0F;&#x5B66;</span></div><div class="line">        createSubjectRadio(<span class="number">2</span>,subjectRadio);<span class="comment">//&#x521B;&#x5EFA;&#x79D1;&#x76EE;&#x5355;&#x9009;&#xFF0C;&#x6839;&#x636E;&#x5B66;&#x6BB5;&#xFF0C;&#x9ED8;&#x8BA4;&#x5C0F;&#x5B66;</span></div><div class="line"></div><div class="line">        WindowManager wm = (WindowManager) getSystemService(WINDOW_SERVICE);</div><div class="line">        <span class="keyword">int</span> width = (<span class="keyword">int</span>) ((wm.getDefaultDisplay().getWidth()) * <span class="number">0.35</span>);<span class="comment">//&#x83B7;&#x53D6;&#x5C4F;&#x5E55;&#x5BBD;&#x5EA6;&#x7684;0.35&#x500D;&#x8D4B;&#x7ED9;&#x8BE5;popupWindow</span></div><div class="line">        <span class="keyword">final</span> PopupWindow popupWindow = <span class="keyword">new</span> PopupWindow(contentView,</div><div class="line">                LinearLayout.LayoutParams.MATCH_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT, <span class="keyword">true</span>);</div><div class="line">        popupWindow.setAnimationStyle(R.style.popwin_anim_style);</div><div class="line"></div><div class="line">        popupWindow.setTouchable(<span class="keyword">true</span>);</div><div class="line"></div><div class="line">        popupWindow.setTouchInterceptor(<span class="keyword">new</span> View.OnTouchListener() {</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouch</span><span class="params">(View v, MotionEvent event)</span> </span>{</div><div class="line"></div><div class="line">                Log.i(<span class="string">&quot;mengdd&quot;</span>, <span class="string">&quot;onTouch : &quot;</span>);</div><div class="line"></div><div class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">                <span class="comment">// &#x8FD9;&#x91CC;&#x5982;&#x679C;&#x8FD4;&#x56DE;true&#x7684;&#x8BDD;&#xFF0C;touch&#x4E8B;&#x4EF6;&#x5C06;&#x88AB;&#x62E6;&#x622A;</span></div><div class="line">                <span class="comment">// &#x62E6;&#x622A;&#x540E; PopupWindow&#x7684;onTouchEvent&#x4E0D;&#x88AB;&#x8C03;&#x7528;&#xFF0C;&#x8FD9;&#x6837;&#x70B9;&#x51FB;&#x5916;&#x90E8;&#x533A;&#x57DF;&#x65E0;&#x6CD5;dismiss</span></div><div class="line">            }</div><div class="line">        });</div><div class="line"></div><div class="line">        <span class="comment">// &#x5982;&#x679C;&#x4E0D;&#x8BBE;&#x7F6E;PopupWindow&#x7684;&#x80CC;&#x666F;&#xFF0C;&#x65E0;&#x8BBA;&#x662F;&#x70B9;&#x51FB;&#x5916;&#x90E8;&#x533A;&#x57DF;&#x8FD8;&#x662F;Back&#x952E;&#x90FD;&#x65E0;&#x6CD5;dismiss&#x5F39;&#x6846;</span></div><div class="line">        <span class="comment">// &#x6211;&#x89C9;&#x5F97;&#x8FD9;&#x91CC;&#x662F;API&#x7684;&#x4E00;&#x4E2A;bug</span></div><div class="line">        popupWindow.setBackgroundDrawable(<span class="keyword">new</span> ColorDrawable(getResources().getColor(R.color.transparent)));</div><div class="line"></div><div class="line">        <span class="comment">// &#x8BBE;&#x7F6E;&#x597D;&#x53C2;&#x6570;&#x4E4B;&#x540E;&#x518D;show</span></div><div class="line">        popupWindow.showAsDropDown(view);</div><div class="line"><span class="comment">//        popupWindow.showAtLocation(view, Gravity.RIGHT | Gravity.TOP, ScreenUtil.dip2px(this, 8), ScreenUtil.dip2px(this, 70));</span></div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createPhaseRadio</span><span class="params">(RadioGroup radioGroup)</span></span>{</div><div class="line">        RadioButton tempButton1 = getBaseRadioButton();</div><div class="line">        tempButton1.setText(<span class="string">&quot;&#x5C0F;&#x5B66;&quot;</span>);</div><div class="line">        tempButton1.setTag(phaseCode[<span class="number">0</span>]);</div><div class="line"></div><div class="line">        radioGroup.addView(tempButton1, getbaseLayoutParams());</div><div class="line">        RadioButton tempButton2 = getBaseRadioButton();</div><div class="line">        tempButton2.setText(<span class="string">&quot;&#x521D;&#x4E2D;&quot;</span>);</div><div class="line">        tempButton2.setTag(phaseCode[<span class="number">1</span>]);</div><div class="line">        radioGroup.addView(tempButton2, getbaseLayoutParams());</div><div class="line">        RadioButton tempButton3 = getBaseRadioButton();</div><div class="line">        tempButton3.setText(<span class="string">&quot;&#x9AD8;&#x4E2D;&quot;</span>);</div><div class="line">        tempButton3.setTag(phaseCode[<span class="number">2</span>]);</div><div class="line">        radioGroup.addView(tempButton3, getbaseLayoutParams());</div><div class="line"></div><div class="line">        tempButton1.setChecked(<span class="keyword">true</span>);<span class="comment">//&#x9ED8;&#x8BA4;&#x5C0F;&#x5B66;</span></div><div class="line">        phaseId = <span class="string">&quot;2&quot;</span>;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createGradeRadio</span><span class="params">(<span class="keyword">int</span> phase,RadioGroup radioGroup)</span></span>{</div><div class="line">        radioGroup.removeAllViews();</div><div class="line">        <span class="keyword">switch</span> (phase){</div><div class="line">            <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                RadioButton tempButton1 = getBaseRadioButton();</div><div class="line">                tempButton1.setText(<span class="string">&quot;&#x4E00;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton1.setTag(gradeCode[<span class="number">0</span>]);</div><div class="line">                radioGroup.addView(tempButton1, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton2 = getBaseRadioButton();</div><div class="line">                tempButton2.setText(<span class="string">&quot;&#x4E8C;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton2.setTag(gradeCode[<span class="number">1</span>]);</div><div class="line">                radioGroup.addView(tempButton2, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton3 = getBaseRadioButton();</div><div class="line">                tempButton3.setText(<span class="string">&quot;&#x4E09;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton3.setTag(gradeCode[<span class="number">2</span>]);</div><div class="line">                radioGroup.addView(tempButton3, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton4 = getBaseRadioButton();</div><div class="line">                tempButton4.setText(<span class="string">&quot;&#x56DB;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton4.setTag(gradeCode[<span class="number">3</span>]);</div><div class="line">                radioGroup.addView(tempButton4, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton5 = getBaseRadioButton();</div><div class="line">                tempButton5.setText(<span class="string">&quot;&#x4E94;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton5.setTag(gradeCode[<span class="number">4</span>]);</div><div class="line">                radioGroup.addView(tempButton5, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton6 = getBaseRadioButton();</div><div class="line">                tempButton6.setText(<span class="string">&quot;&#x516D;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton6.setTag(gradeCode[<span class="number">5</span>]);</div><div class="line">                radioGroup.addView(tempButton6, getbaseLayoutParams());</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">            <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">                RadioButton tempButton7 = getBaseRadioButton();</div><div class="line">                tempButton7.setText(<span class="string">&quot;&#x4E00;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton7.setTag(gradeCode[<span class="number">0</span>]);</div><div class="line">                radioGroup.addView(tempButton7, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton8 = getBaseRadioButton();</div><div class="line">                tempButton8.setText(<span class="string">&quot;&#x4E8C;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton8.setTag(gradeCode[<span class="number">1</span>]);</div><div class="line">                radioGroup.addView(tempButton8, getbaseLayoutParams());</div><div class="line">                RadioButton tempButton9 = getBaseRadioButton();</div><div class="line">                tempButton9.setText(<span class="string">&quot;&#x4E09;&#x5E74;&#x7EA7;&quot;</span>);</div><div class="line">                tempButton9.setTag(gradeCode[<span class="number">2</span>]);</div><div class="line">                radioGroup.addView(tempButton9, getbaseLayoutParams());</div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        }</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">createSubjectRadio</span><span class="params">(<span class="keyword">final</span> <span class="keyword">int</span> phase, <span class="keyword">final</span> RadioGroup radioGroup)</span></span>{</div><div class="line">        dialogHelper.showProgressDialog(<span class="string">&quot;&#x52A0;&#x8F7D;&#x4E2D;...&quot;</span>);</div><div class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() {</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</div><div class="line">                String jsonStr=<span class="string">&quot;&quot;</span>;</div><div class="line">                <span class="keyword">switch</span> (phase){</div><div class="line">                    <span class="keyword">case</span> <span class="number">2</span>:</div><div class="line">                        jsonStr = AppJsonFileReader.getJson(OpenClassActivity.<span class="keyword">this</span>,primaryUrl);<span class="comment">//&#x5C0F;&#x5B66;</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> <span class="number">3</span>:</div><div class="line">                        jsonStr = AppJsonFileReader.getJson(OpenClassActivity.<span class="keyword">this</span>,juniorUrl);<span class="comment">//&#x521D;&#x4E2D;</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                    <span class="keyword">case</span> <span class="number">4</span>:</div><div class="line">                        jsonStr = AppJsonFileReader.getJson(OpenClassActivity.<span class="keyword">this</span>,seniorUrl);<span class="comment">//&#x9AD8;&#x4E2D;</span></div><div class="line">                        <span class="keyword">break</span>;</div><div class="line">                }</div><div class="line"></div><div class="line"></div><div class="line">                <span class="keyword">final</span> List&lt;Map&lt;String, String&gt;&gt; data = AppJsonFileReader.setListData(jsonStr);</div><div class="line"></div><div class="line"><span class="comment">//                    list.addAll(mCources);</span></div><div class="line">                runOnUiThread(<span class="keyword">new</span> Runnable() {</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</div><div class="line">                        radioGroup.removeAllViews();</div><div class="line">                        subjectCode.clear();</div><div class="line">                        radioGroup.setOrientation(LinearLayout.HORIZONTAL);</div><div class="line">                        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;data.size();i++){</div><div class="line">                            RadioButton tempButton = getBaseRadioButton();</div><div class="line">                            tempButton.setText(data.get(i).get(<span class="string">&quot;Name&quot;</span>));</div><div class="line">                            tempButton.setTag(data.get(i).get(<span class="string">&quot;Code&quot;</span>));</div><div class="line">                            radioGroup.addView(tempButton, getbaseLayoutParams());</div><div class="line">                            subjectCode.add(data.get(i).get(<span class="string">&quot;Code&quot;</span>));</div><div class="line">                        }</div><div class="line">                        dialogHelper.dismissProgressDialog();</div><div class="line">                    }</div><div class="line">                });</div><div class="line">            }</div><div class="line">        }).start();</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> RadioButton <span class="title">getBaseRadioButton</span><span class="params">()</span></span>{</div><div class="line">        RadioButton tempButton = <span class="keyword">new</span> RadioButton(<span class="keyword">this</span>);</div><div class="line"><span class="comment">//                        tempButton.setTextSize(ScreenUtil.dip2px(context, 5));</span></div><div class="line">        tempButton.setTextSize(TypedValue.COMPLEX_UNIT_SP,<span class="number">16</span>);</div><div class="line">        tempButton.setTextColor(getResources().getColorStateList(R.color.filter_phase_text_selecter));</div><div class="line">        tempButton.setButtonDrawable(getResources().getDrawable(android.R.color.transparent));</div><div class="line"><span class="comment">//        tempButton.setCompoundDrawablesWithIntrinsicBounds(null, null, null, null);</span></div><div class="line"></div><div class="line"></div><div class="line">        tempButton.setBackgroundResource(R.drawable.filter_phase_selecter);</div><div class="line"><span class="comment">//        tempButton.setCompoundDrawablePadding(ScreenUtil.dip2px(getActivity(), 10));</span></div><div class="line"><span class="comment">//        tempButton.setPadding(20, 20, 20, 20);                 // &#x8BBE;&#x7F6E;&#x6587;&#x5B57;&#x8DDD;&#x79BB;&#x6309;&#x94AE;&#x56DB;&#x5468;&#x7684;&#x8DDD;&#x79BB;</span></div><div class="line"></div><div class="line"><span class="comment">//        layoutParams.weight =0.3f;</span></div><div class="line"><span class="comment">//        tempButton.setLayoutParams(layoutParams);</span></div><div class="line">        <span class="keyword">return</span> tempButton;</div><div class="line">    }</div><div class="line"></div><div class="line">    <span class="keyword">private</span> RadioGroup.<span class="function">LayoutParams <span class="title">getbaseLayoutParams</span><span class="params">()</span></span>{</div><div class="line">        RadioGroup.LayoutParams layoutParams = <span class="keyword">new</span> RadioGroup.LayoutParams(RadioGroup.LayoutParams.WRAP_CONTENT, RadioGroup.LayoutParams.WRAP_CONTENT);</div><div class="line">        layoutParams.setMargins(<span class="number">15</span>,<span class="number">15</span>,<span class="number">15</span>,<span class="number">15</span>);</div><div class="line">        <span class="keyword">return</span> layoutParams;</div><div class="line">    }</div></pre></td></tr></table></figure>
<p>&#x52A8;&#x6001;&#x521B;&#x5EFA;radiobutton&#x7684;&#x5730;&#x65B9;&#x7EA0;&#x7ED3;&#x4E86;&#x597D;&#x4E45;&#xFF0C;&#x4E3B;&#x8981;&#x662F;&#x8BBE;&#x7F6E;margin&#x4E0D;&#x751F;&#x6548;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x8981;&#x7528;RadioGroup.LayoutParams&#xFF0C;&#x5728;stackoverflow&#x4E0A;&#x627E;&#x5230;&#x7684;&#x89E3;&#x51B3;&#x529E;&#x6CD5;&#x3002;</p>
<p>&#x670D;&#x52A1;&#x7AEF;&#x7684;&#x8FC7;&#x6EE4;&#x6570;&#x636E;&#x5199;&#x7684;&#x662F;&#x914D;&#x7F6E;&#xFF0C;&#x4E0D;&#x4F1A;&#x53D8;&#x7684;&#x7684;&#x5B66;&#x6BB5;&#x548C;&#x5E74;&#x7EA7;&#x5C31;&#x76F4;&#x63A5;&#x5199;&#x6B7B;&#x4E86;&#xFF0C;&#x79D1;&#x76EE;&#x5199;&#x7684;json&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x52A8;&#x6001;&#x8BFB;&#x53D6;&#x3002;</p>
<p>popup&#x7684;xml<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</div><div class="line">    xmlns:student=&quot;http://schemas.android.com/apk/res-auto&quot;</div><div class="line">    android:id=&quot;@id/openclass_filter&quot;</div><div class="line">    android:layout_width=&quot;match_parent&quot;</div><div class="line">    android:layout_height=&quot;match_parent&quot;</div><div class="line">    android:background=&quot;@color/white&quot;</div><div class="line">    android:orientation=&quot;vertical&quot;&gt;</div><div class="line"></div><div class="line"></div><div class="line">    &lt;RelativeLayout</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;wrap_content&quot;</div><div class="line">        android:layout_gravity=&quot;center_vertical&quot;</div><div class="line">        android:layout_marginBottom=&quot;15dp&quot;</div><div class="line">        android:layout_marginLeft=&quot;15dp&quot;</div><div class="line">        android:layout_marginTop=&quot;15dp&quot;&gt;</div><div class="line"></div><div class="line">        &lt;TextView</div><div class="line">            android:id=&quot;@id/openclass_condition_phase&quot;</div><div class="line">            android:layout_width=&quot;wrap_content&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_marginRight=&quot;8dp&quot;</div><div class="line">            android:layout_marginTop=&quot;8dp&quot;</div><div class="line">            android:text=&quot;@string/openclass_screening_phase&quot;</div><div class="line">            android:textSize=&quot;20sp&quot; /&gt;</div><div class="line"></div><div class="line">        &lt;com.tyky.edu.teacher.main.ui.RadioGroupEx</div><div class="line">            android:id=&quot;@+id/openclass_radio_phase&quot;</div><div class="line">            android:layout_width=&quot;match_parent&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_toRightOf=&quot;@id/openclass_condition_phase&quot;&gt;&lt;/com.tyky.edu.teacher.main.ui.RadioGroupEx&gt;</div><div class="line">    &lt;/RelativeLayout&gt;</div><div class="line"></div><div class="line">    &lt;TextView</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;1dp&quot;</div><div class="line">        android:layout_marginLeft=&quot;8dp&quot;</div><div class="line">        android:layout_marginRight=&quot;8dp&quot;</div><div class="line">        android:background=&quot;@color/filter_radio_line&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;RelativeLayout</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;wrap_content&quot;</div><div class="line">        android:layout_marginBottom=&quot;15dp&quot;</div><div class="line">        android:layout_marginLeft=&quot;15dp&quot;</div><div class="line">        android:layout_marginTop=&quot;15dp&quot;&gt;</div><div class="line"></div><div class="line">        &lt;TextView</div><div class="line">            android:id=&quot;@id/openclass_condition_grade&quot;</div><div class="line">            android:layout_width=&quot;wrap_content&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_marginRight=&quot;8dp&quot;</div><div class="line">            android:layout_marginTop=&quot;8dp&quot;</div><div class="line">            android:text=&quot;@string/openclass_screening_grade&quot;</div><div class="line">            android:textSize=&quot;20sp&quot; /&gt;</div><div class="line"></div><div class="line">        &lt;com.tyky.edu.teacher.main.ui.RadioGroupEx</div><div class="line">            android:id=&quot;@+id/openclass_radio_grade&quot;</div><div class="line">            android:layout_width=&quot;match_parent&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_toRightOf=&quot;@id/openclass_condition_grade&quot;&gt;&lt;/com.tyky.edu.teacher.main.ui.RadioGroupEx&gt;</div><div class="line">    &lt;/RelativeLayout&gt;</div><div class="line"></div><div class="line">    &lt;TextView</div><div class="line">        android:layout_width=&quot;match_parent&quot;</div><div class="line">        android:layout_height=&quot;1dp&quot;</div><div class="line">        android:layout_marginLeft=&quot;8dp&quot;</div><div class="line">        android:layout_marginRight=&quot;8dp&quot;</div><div class="line">        android:background=&quot;@color/filter_radio_line&quot; /&gt;</div><div class="line"></div><div class="line">    &lt;RelativeLayout</div><div class="line">        android:layout_width=&quot;wrap_content&quot;</div><div class="line">        android:layout_height=&quot;wrap_content&quot;</div><div class="line">        android:layout_marginBottom=&quot;15dp&quot;</div><div class="line">        android:layout_marginLeft=&quot;15dp&quot;</div><div class="line">        android:layout_marginTop=&quot;15dp&quot;&gt;</div><div class="line"></div><div class="line">        &lt;TextView</div><div class="line">            android:id=&quot;@id/openclass_condition_subject&quot;</div><div class="line">            android:layout_width=&quot;wrap_content&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_marginRight=&quot;8dp&quot;</div><div class="line">            android:layout_marginTop=&quot;8dp&quot;</div><div class="line">            android:text=&quot;@string/openclass_screening_subject&quot;</div><div class="line">            android:textSize=&quot;20sp&quot; /&gt;</div><div class="line"></div><div class="line">        &lt;ScrollView</div><div class="line">            android:layout_width=&quot;match_parent&quot;</div><div class="line">            android:layout_height=&quot;wrap_content&quot;</div><div class="line">            android:layout_toRightOf=&quot;@id/openclass_condition_subject&quot;</div><div class="line">            android:fillViewport=&quot;true&quot;&gt;</div><div class="line"></div><div class="line">            &lt;com.tyky.edu.teacher.main.ui.RadioGroupEx</div><div class="line">                android:id=&quot;@+id/openclass_radio_subject&quot;</div><div class="line">                android:layout_width=&quot;match_parent&quot;</div><div class="line">                android:layout_height=&quot;wrap_content&quot;</div><div class="line">                &gt;&lt;/com.tyky.edu.teacher.main.ui.RadioGroupEx&gt;</div><div class="line">        &lt;/ScrollView&gt;</div><div class="line">    &lt;/RelativeLayout&gt;</div><div class="line"></div><div class="line"></div><div class="line">&lt;/LinearLayout&gt;</div></pre></td></tr></table></figure></p>
<h3 id="3-&#x76F4;&#x63A5;&#x5728;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x51FA;&#x8C03;&#x7528;showPopupWindowFilter&#x65E2;&#x53EF;"><a href="#3-&#x76F4;&#x63A5;&#x5728;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x51FA;&#x8C03;&#x7528;showPopupWindowFilter&#x65E2;&#x53EF;" class="headerlink" title="3.&#x76F4;&#x63A5;&#x5728;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x51FA;&#x8C03;&#x7528;showPopupWindowFilter&#x65E2;&#x53EF;"></a>3.&#x76F4;&#x63A5;&#x5728;&#x70B9;&#x51FB;&#x4E8B;&#x4EF6;&#x51FA;&#x8C03;&#x7528;showPopupWindowFilter&#x65E2;&#x53EF;</h3><h3 id="&#x8FD9;&#x91CC;popup&#x5F39;&#x51FA;&#x7528;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6298;&#x53E0;&#x52A8;&#x753B;"><a href="#&#x8FD9;&#x91CC;popup&#x5F39;&#x51FA;&#x7528;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6298;&#x53E0;&#x52A8;&#x753B;" class="headerlink" title="&#x8FD9;&#x91CC;popup&#x5F39;&#x51FA;&#x7528;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6298;&#x53E0;&#x52A8;&#x753B;"></a>&#x8FD9;&#x91CC;popup&#x5F39;&#x51FA;&#x7528;&#x5230;&#x4E86;&#x4E00;&#x4E2A;&#x6298;&#x53E0;&#x52A8;&#x753B;</h3><p>&#x4E0B;&#x9762;&#x9644;&#x4E0A;&#x4EE3;&#x7801;&#xFF0C;&#x4EE5;&#x540E;&#x6709;&#x65F6;&#x95F4;&#x518D;&#x8BE6;&#x7EC6;&#x5199;&#x5199;&#x5404;&#x79CD;&#x52A8;&#x753B;</p>
<p>style:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;style name=&quot;popwin_anim_style&quot;&gt;</div><div class="line">        &lt;item name=&quot;android:windowEnterAnimation&quot;&gt;@anim/popup_show_anim&lt;/item&gt;</div><div class="line">        &lt;item name=&quot;android:windowExitAnimation&quot;&gt;@anim/popup_hide_anim&lt;/item&gt;</div><div class="line">    &lt;/style&gt;</div></pre></td></tr></table></figure></p>
<p>popup_show_anim:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line">    &lt;scale</div><div class="line">        android:fromXScale=&quot;1.0&quot;</div><div class="line">        android:toXScale=&quot;1.0&quot;</div><div class="line">        android:fromYScale=&quot;0.0&quot;</div><div class="line">        android:toYScale=&quot;1.0&quot;</div><div class="line">        android:pivotX=&quot;100%&quot;</div><div class="line">        android:pivotY=&quot;0&quot;</div><div class="line">        android:duration=&quot;300&quot; /&gt;</div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure></p>
<p>popup_hide_anim:<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;set xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line">    &lt;scale</div><div class="line">        android:fromXScale=&quot;1.0&quot;</div><div class="line">        android:toXScale=&quot;1.0&quot;</div><div class="line">        android:fromYScale=&quot;1.0&quot;</div><div class="line">        android:toYScale=&quot;0.0&quot;</div><div class="line">        android:pivotX=&quot;100%&quot;</div><div class="line">        android:pivotY=&quot;0&quot;</div><div class="line">        android:duration=&quot;300&quot; /&gt;</div><div class="line">&lt;/set&gt;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/15/使用drawable来实现圆形按钮以及点击效果/" itemprop="url">
                  使用drawable来实现圆形按钮以及点击效果
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-15T20:20:13+08:00" content="2016-08-15">
              2016-08-15
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/15/使用drawable来实现圆形按钮以及点击效果/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/15/使用drawable来实现圆形按钮以及点击效果/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/15/使用drawable来实现圆形按钮以及点击效果/" class="leancloud_visitors" data-flag-title="使用drawable来实现圆形按钮以及点击效果">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x4ECA;&#x5929;&#x8981;&#x505A;&#x4E00;&#x4E2A;&#x89C6;&#x9891;&#x5F55;&#x5236;&#x7684;&#x529F;&#x80FD;&#xFF0C;&#x5F55;&#x5236;&#x7684;&#x6309;&#x94AE;&#x8981;&#x548C;ios&#x7684;&#x4E00;&#x81F4;&#xFF0C;&#x89C9;&#x5F97;&#x7528;drawable&#x5B9E;&#x73B0;&#x66F4;&#x7B80;&#x5355;&#xFF0C;&#x4E0B;&#x9762;&#x5148;&#x770B;&#x770B;&#x6548;&#x679C;<br><img src="/2016/08/15/&#x4F7F;&#x7528;drawable&#x6765;&#x5B9E;&#x73B0;&#x5706;&#x5F62;&#x6309;&#x94AE;&#x4EE5;&#x53CA;&#x70B9;&#x51FB;&#x6548;&#x679C;/btn_normal.jpg" alt="btn_normal"><br><img src="/2016/08/15/&#x4F7F;&#x7528;drawable&#x6765;&#x5B9E;&#x73B0;&#x5706;&#x5F62;&#x6309;&#x94AE;&#x4EE5;&#x53CA;&#x70B9;&#x51FB;&#x6548;&#x679C;/btn_click.jpg" alt="btn_click"></p>
<h3 id="1-&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;record-normal-shape-xml"><a href="#1-&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;record-normal-shape-xml" class="headerlink" title="1.&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;record_normal_shape.xml"></a>1.&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;record_normal_shape.xml</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;</div><div class="line">    &lt;item&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/white&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">            android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line"></div><div class="line">    &lt;item android:bottom=&quot;2dp&quot;</div><div class="line">        android:top=&quot;2dp&quot;</div><div class="line">        android:left=&quot;2dp&quot;</div><div class="line">        android:right=&quot;2dp&quot;&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/black&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">                android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line"></div><div class="line">    &lt;item android:bottom=&quot;4dp&quot;</div><div class="line">        android:top=&quot;4dp&quot;</div><div class="line">        android:left=&quot;4dp&quot;</div><div class="line">        android:right=&quot;4dp&quot;&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/white&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">                android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line">&lt;/layer-list&gt;</div></pre></td></tr></table></figure>
<h3 id="2-&#x65B0;&#x5EFA;record-click-shape-xml"><a href="#2-&#x65B0;&#x5EFA;record-click-shape-xml" class="headerlink" title="2.&#x65B0;&#x5EFA;record_click_shape.xml"></a>2.&#x65B0;&#x5EFA;record_click_shape.xml</h3><p>&#x4EE3;&#x7801;&#x57FA;&#x672C;&#x548C;&#x4E0A;&#x9762;&#x4E00;&#x6837;&#xFF0C;&#x53EA;&#x662F;&#x989C;&#x8272;&#x7531;&#x767D;&#x8272;&#x53D8;&#x4E3A;&#x7EA2;&#x8272;<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;layer-list xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot; &gt;</div><div class="line">    &lt;item&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/white&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">            android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line"></div><div class="line">    &lt;item android:bottom=&quot;2dp&quot;</div><div class="line">        android:top=&quot;2dp&quot;</div><div class="line">        android:left=&quot;2dp&quot;</div><div class="line">        android:right=&quot;2dp&quot;&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/black&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">                android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line"></div><div class="line">    &lt;item android:bottom=&quot;4dp&quot;</div><div class="line">        android:top=&quot;4dp&quot;</div><div class="line">        android:left=&quot;4dp&quot;</div><div class="line">        android:right=&quot;4dp&quot;&gt;</div><div class="line">        &lt;shape android:shape=&quot;oval&quot; &gt;</div><div class="line">            &lt;solid</div><div class="line">                android:color=&quot;@color/red&quot;/&gt;</div><div class="line">            &lt;size android:width=&quot;20dp&quot;</div><div class="line">                android:height=&quot;20dp&quot;/&gt;</div><div class="line">        &lt;/shape&gt;</div><div class="line">    &lt;/item&gt;</div><div class="line">&lt;/layer-list&gt;</div></pre></td></tr></table></figure></p>
<h3 id="3-&#x65B0;&#x5EFA;record-statue-selector-xml"><a href="#3-&#x65B0;&#x5EFA;record-statue-selector-xml" class="headerlink" title="3.&#x65B0;&#x5EFA;record_statue_selector.xml"></a>3.&#x65B0;&#x5EFA;record_statue_selector.xml</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</div><div class="line">&lt;selector xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;</div><div class="line"></div><div class="line">    &lt;item android:drawable=&quot;@drawable/record_click_shape&quot; android:state_focused=&quot;true&quot;/&gt;</div><div class="line">    &lt;item android:drawable=&quot;@drawable/record_click_shape&quot; android:state_pressed=&quot;true&quot;/&gt;</div><div class="line">    &lt;item android:drawable=&quot;@drawable/record_click_shape&quot; android:state_selected=&quot;true&quot;/&gt;</div><div class="line">    &lt;item android:drawable=&quot;@drawable/record_normal_shape&quot;/&gt;</div><div class="line"></div><div class="line">&lt;/selector&gt;</div></pre></td></tr></table></figure>
<h3 id="4-&#x76F4;&#x63A5;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x6DFB;&#x52A0;background&#x65E2;&#x53EF;"><a href="#4-&#x76F4;&#x63A5;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x6DFB;&#x52A0;background&#x65E2;&#x53EF;" class="headerlink" title="4.&#x76F4;&#x63A5;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x6DFB;&#x52A0;background&#x65E2;&#x53EF;"></a>4.&#x76F4;&#x63A5;&#x5728;&#x5E03;&#x5C40;&#x6587;&#x4EF6;&#x4E2D;&#x6DFB;&#x52A0;background&#x65E2;&#x53EF;</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;ImageButton</div><div class="line">                android:id=<span class="string">&quot;@id/btn_recorder_record&quot;</span></div><div class="line">                android:layout_width=<span class="string">&quot;70dp&quot;</span></div><div class="line">                android:layout_height=<span class="string">&quot;70dp&quot;</span></div><div class="line">                android:layout_centerInParent=<span class="string">&quot;true&quot;</span></div><div class="line">                android:background=<span class="string">&quot;@drawable/record_statue_selecter&quot;</span> /&gt;</div></pre></td></tr></table></figure>
<p>&#x5B9E;&#x73B0;&#x8D77;&#x6765;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x4E0D;&#x4F46;&#x53EF;&#x4EE5;&#x753B;&#x51FA;&#x5706;&#x5F62;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x753B;&#x77E9;&#x5F62;&#xFF0C;&#x76F4;&#x7EBF;&#xFF0C;&#x73AF;&#x5F62;&#xFF0C;&#x692D;&#x5706;&#x3002;&#x4EE5;&#x53CA;&#x8BBE;&#x7F6E;&#x5706;&#x89D2;&#xFF0C;&#x8FB9;&#x7EBF;&#x7B49;&#x7B49;&#x3002;</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/09/Android读取json配置/" itemprop="url">
                  Android读取json配置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-09T16:02:00+08:00" content="2016-08-09">
              2016-08-09
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/09/Android读取json配置/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/09/Android读取json配置/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/09/Android读取json配置/" class="leancloud_visitors" data-flag-title="Android读取json配置">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x5DE5;&#x4F5C;&#x7684;&#x65B0;&#x9700;&#x6C42;&#xFF0C;&#x9700;&#x8981;&#x52A0;&#x8FC7;&#x6EE4;&#xFF0C;&#x4F46;&#x662F;&#x8FC7;&#x6EE4;&#x7684;&#x5B57;&#x6BB5;&#x6CA1;&#x6709;&#x670D;&#x52A1;&#xFF0C;&#x53EA;&#x80FD;&#x50CF;&#x670D;&#x52A1;&#x7AEF;&#x4E00;&#x6837;&#x5199;&#x672C;&#x5730;&#x914D;&#x7F6E;&#x5316;&#x3002;&#x3002;&#x3002;orz<br>&#x628A;&#x914D;&#x7F6E;&#x5199;&#x6210;json&#x683C;&#x5F0F;&#x653E;&#x5728;assets&#x4E0B;&#x9762;&#x3002;</p>
<h3 id="1-&#x6784;&#x9020;json&#x653E;&#x5728;assets&#x4E0B;&#x9762;&#xFF0C;&#x5982;&#x56FE;"><a href="#1-&#x6784;&#x9020;json&#x653E;&#x5728;assets&#x4E0B;&#x9762;&#xFF0C;&#x5982;&#x56FE;" class="headerlink" title="1.&#x6784;&#x9020;json&#x653E;&#x5728;assets&#x4E0B;&#x9762;&#xFF0C;&#x5982;&#x56FE;"></a>1.&#x6784;&#x9020;json&#x653E;&#x5728;assets&#x4E0B;&#x9762;&#xFF0C;&#x5982;&#x56FE;</h3><p><img src="/2016/08/09/Android&#x8BFB;&#x53D6;json&#x914D;&#x7F6E;/filter.jpg" alt="filter"></p>
<h3 id="2-&#x5199;&#x4E00;&#x4E2A;util-&#x4EE3;&#x7801;&#x5982;&#x4E0B;"><a href="#2-&#x5199;&#x4E00;&#x4E2A;util-&#x4EE3;&#x7801;&#x5982;&#x4E0B;" class="headerlink" title="2.&#x5199;&#x4E00;&#x4E2A;util &#x4EE3;&#x7801;&#x5982;&#x4E0B;"></a>2.&#x5199;&#x4E00;&#x4E2A;util &#x4EE3;&#x7801;&#x5982;&#x4E0B;</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.content.res.AssetManager;</div><div class="line"></div><div class="line"><span class="keyword">import</span> org.json.JSONArray;</div><div class="line"><span class="keyword">import</span> org.json.JSONException;</div><div class="line"><span class="keyword">import</span> org.json.JSONObject;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.io.BufferedReader;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.InputStreamReader;</div><div class="line"><span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><span class="keyword">import</span> java.util.HashMap;</div><div class="line"><span class="keyword">import</span> java.util.List;</div><div class="line"><span class="keyword">import</span> java.util.Map;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Dino on 8/9 0009.</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppJsonFileReader</span> </span>{</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJson</span><span class="params">(Context context, String fileName)</span> </span>{</div><div class="line"></div><div class="line">        StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</div><div class="line">        <span class="keyword">try</span> {</div><div class="line">            AssetManager assetManager = context.getAssets();</div><div class="line">            BufferedReader bf = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(</div><div class="line">                    assetManager.open(fileName)));</div><div class="line">            String line;</div><div class="line">            <span class="keyword">while</span> ((line = bf.readLine()) != <span class="keyword">null</span>) {</div><div class="line">                stringBuilder.append(line);</div><div class="line">            }</div><div class="line">        } <span class="keyword">catch</span> (IOException e) {</div><div class="line">            e.printStackTrace();</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> stringBuilder.toString();</div><div class="line">    }</div><div class="line"></div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> List&lt;Map&lt;String, String&gt;&gt; setListData(String str) {</div><div class="line">        List&lt;Map&lt;String, String&gt;&gt; data = <span class="keyword">new</span> ArrayList&lt;Map&lt;String, String&gt;&gt;();</div><div class="line">        <span class="keyword">try</span> {</div><div class="line"></div><div class="line">            JSONArray array = <span class="keyword">new</span> JSONArray(str);</div><div class="line">            <span class="keyword">int</span> len = array.length();</div><div class="line">            Map&lt;String, String&gt; map;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) {</div><div class="line">                JSONObject object = array.getJSONObject(i);</div><div class="line">                map = <span class="keyword">new</span> HashMap&lt;String, String&gt;();</div><div class="line">                map.put(<span class="string">&quot;Code&quot;</span>, object.getString(<span class="string">&quot;Code&quot;</span>));</div><div class="line">                map.put(<span class="string">&quot;Name&quot;</span>, object.getString(<span class="string">&quot;Name&quot;</span>));</div><div class="line">                data.add(map);</div><div class="line">            }</div><div class="line"></div><div class="line">        } <span class="keyword">catch</span> (JSONException e) {</div><div class="line">            e.printStackTrace();</div><div class="line">        }</div><div class="line">        <span class="keyword">return</span> data;</div><div class="line"></div><div class="line">    }</div><div class="line">}</div></pre></td></tr></table></figure>
<h3 id="3-&#x5728;activity&#x91CC;&#x9762;&#x8C03;&#x7528;&#x4EE3;&#x7801;&#xFF1A;"><a href="#3-&#x5728;activity&#x91CC;&#x9762;&#x8C03;&#x7528;&#x4EE3;&#x7801;&#xFF1A;" class="headerlink" title="3.&#x5728;activity&#x91CC;&#x9762;&#x8C03;&#x7528;&#x4EE3;&#x7801;&#xFF1A;"></a>3.&#x5728;activity&#x91CC;&#x9762;&#x8C03;&#x7528;&#x4EE3;&#x7801;&#xFF1A;</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String primary = <span class="string">&quot;www/js/primary_class_phase.json&quot;</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String junior = <span class="string">&quot;www/js/junior_class_phase.json&quot;</span>;</div><div class="line"><span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> String senior = <span class="string">&quot;www/js/senior_class_phase.json&quot;</span>;</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() {</div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</div><div class="line">                String jsonStr=<span class="string">&quot;&quot;</span>;</div><div class="line">                <span class="keyword">if</span>(<span class="string">&quot;2&quot;</span>.equals(phase)){<span class="comment">//&#x5C0F;&#x5B66;</span></div><div class="line">                    jsonStr = AppJsonFileReader.getJson(getActivity(),primary);</div><div class="line">                }<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;3&quot;</span>.equals(phase)){<span class="comment">//&#x521D;&#x4E2D;</span></div><div class="line">                    jsonStr = AppJsonFileReader.getJson(getActivity(),junior);</div><div class="line">                }<span class="keyword">else</span> <span class="keyword">if</span>(<span class="string">&quot;4&quot;</span>.equals(phase)){<span class="comment">//&#x9AD8;&#x4E2D;</span></div><div class="line">                    jsonStr = AppJsonFileReader.getJson(getActivity(),senior);</div><div class="line">                }</div><div class="line"></div><div class="line"></div><div class="line">                List&lt;Map&lt;String, String&gt;&gt; data = AppJsonFileReader.setListData(jsonStr);</div><div class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>;i&lt;data.size();i++){</div><div class="line">                    mCources.add(data.get(i).get(<span class="string">&quot;Name&quot;</span>));</div><div class="line">                    mCourcesId.add(data.get(i).get(<span class="string">&quot;Code&quot;</span>));</div><div class="line">                }</div><div class="line">                list.clear();</div><div class="line">                list.addAll(mCources);</div><div class="line">                getActivity().runOnUiThread(<span class="keyword">new</span> Runnable() {</div><div class="line">                    <span class="meta">@Override</span></div><div class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>{</div><div class="line">                        mAdapter = <span class="keyword">new</span> ArrayAdapter&lt;String&gt;(getActivity(), android.R.layout.simple_list_item_1, list);</div><div class="line">                        mListView.setAdapter(mAdapter);</div><div class="line">                    }</div><div class="line">                });</div><div class="line">            }</div><div class="line">        }).start();</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/09/2016-8-9/" itemprop="url">
                  Android6.0权限机制变更
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-09T09:56:28+08:00" content="2016-08-09">
              2016-08-09
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/09/2016-8-9/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/09/2016-8-9/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/09/2016-8-9/" class="leancloud_visitors" data-flag-title="Android6.0权限机制变更">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Android6-0&#x4EE5;&#x524D;"><a href="#Android6-0&#x4EE5;&#x524D;" class="headerlink" title="Android6.0&#x4EE5;&#x524D;"></a>Android6.0&#x4EE5;&#x524D;</h3><p>&#x6240;&#x6709;&#x6743;&#x9650;&#x90FD;&#x5728;&#x5B89;&#x88C5;&#x5E94;&#x7528;&#x65F6;&#x663E;&#x793A;&#x7ED9;&#x7528;&#x6237;&#xFF0C;&#x7528;&#x6237;&#x9009;&#x62E9;&#x5B89;&#x88C5;&#x5219;&#x8868;&#x793A;&#x63A5;&#x53D7;&#x8FD9;&#x4E9B;&#x6743;&#x9650;&#xFF0C;&#x4E4B;&#x540E;&#x65E0;&#x6CD5;&#x64A4;&#x9500;&#x6388;&#x6743;&#x3002;</p>
<h3 id="Android6-0&#x5F00;&#x59CB;"><a href="#Android6-0&#x5F00;&#x59CB;" class="headerlink" title="Android6.0&#x5F00;&#x59CB;"></a>Android6.0&#x5F00;&#x59CB;</h3><p>&#x5728;&#x5B89;&#x88C5;&#x5E94;&#x7528;&#x65F6;&#xFF0C;&#x90E8;&#x5206;&#x5371;&#x9669;&#x6743;&#x9650;&#x4F1A;&#x5C55;&#x793A;&#x7ED9;&#x7528;&#x6237;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E0D;&#x52FE;&#x9009;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x9009;&#x62E9;&#x6388;&#x6743;&#xFF0C;&#x5E76;&#x53EF;&#x4EE5;&#x5728;&#x5B89;&#x88C5;&#x4E4B;&#x540E;&#x8FDB;&#x5165;&#x8BBE;&#x7F6E;&#x64A4;&#x9500;&#x6388;&#x6743;&#x3002;<br>Dangerous permissions:</p>
<ul>
<li>CALENDAR<ul>
<li>READ_CALENDAR</li>
<li>WRITE_CALENDAR</li>
</ul>
</li>
<li>CAMERA<ul>
<li>READ_CALENDAR</li>
<li>WRITE_CALENDAR</li>
</ul>
</li>
<li>CONTACTS<ul>
<li>READ_CONTACTS</li>
<li>WRITE_CONTACTS</li>
<li>GET_ACCOUNTS</li>
</ul>
</li>
<li>LOCATION<ul>
<li>ACCESS_FINE_LOCATION</li>
<li>ACCESS_COARSE_LOCATION</li>
</ul>
</li>
<li>MICROPHONE<ul>
<li>RECORD_AUDIO</li>
</ul>
</li>
<li>PHONE<ul>
<li>READ_PHONE_STATE</li>
<li>CALL_PHONE</li>
<li>READ_CALL_LOG</li>
<li>WRITE_CALL_LOG</li>
<li>ADD_VOICEMAIL</li>
<li>USE_SIP</li>
<li>PROCESS_OUTGOING_CALLS</li>
</ul>
</li>
<li>SENSORS<ul>
<li>BODY_SENSORS</li>
</ul>
</li>
<li>SMS<ul>
<li>SEND_SMS</li>
<li>RECEIVE_SMS</li>
<li>READ_SMS</li>
<li>RECEIVE_WAP_PUSH</li>
<li>RECEIVE_MMS</li>
</ul>
</li>
<li>STORAGE<ul>
<li>READ_EXTERNAL_STORAGE</li>
<li>WRITE_EXTERNAL_STORAGE</li>
</ul>
</li>
</ul>
<p>&#x6743;&#x9650;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;<a href="https://developer.android.com/reference/android/Manifest.permission.html" target="_blank" rel="external">&#x67E5;&#x770B;</a></p>
<p>&#x60F3;&#x8981;&#x67E5;&#x770B;&#x6240;&#x6709;dangerous&#x7684;&#x6743;&#x9650;, &#x4E5F;&#x53EF;&#x4EE5;&#x7528;&#x547D;&#x4EE4;:<br><code>adb shell pm list permissions -g -d</code></p>
<p>Guides&#x91CC;&#x9762;&#x7684;&#x539F;&#x6587;:</p>
<ul>
<li>If the device is running Android 6.0 (API level 23) or higher, and the app&#x2019;s targetSdkVersion is 23 or higher, the app requests permissions from the user at run-time. The user can revoke the permissions at any time, so the app needs to check whether it has the permissions every time it runs. For more information about requesting permissions in your app, see the Working with System Permissions training guide.</li>
<li>If the device is running Android 5.1 (API level 22) or lower, or the app&#x2019;s targetSdkVersion is 22 or lower, the system asks the user to grant the permissions when the user installs the app. If you add a new permission to an updated version of the app, the system asks the user to grant that permission when the user updates the app. Once the user installs the app, the only way they can revoke the permission is by uninstalling the app.</li>
</ul>
<p>&#x53EA;&#x6709;&#x6EE1;&#x8DB3;targetSdkVersion&#x548C;&#x5B9E;&#x9645;&#x4F7F;&#x7528;&#x8BBE;&#x5907;&#x7684;&#x7248;&#x672C;&#x90FD;&#x5728;23&#x53CA;&#x4EE5;&#x4E0A;&#x7684;&#x65F6;&#x5019;,&#x624D;&#x4F1A;&#x91C7;&#x7528;&#x65B0;&#x7684;&#x52A8;&#x6001;&#x6743;&#x9650;&#x673A;&#x5236;. &#x5176;&#x4ED6;&#x60C5;&#x51B5;, &#x8DDF;&#x4E4B;&#x524D;&#x4E00;&#x6837;, &#x5728;&#x5B89;&#x88C5;&#x548C;&#x5347;&#x7EA7;&#x5E94;&#x7528;&#x7684;&#x65F6;&#x5019;&#x5C31;&#x6388;&#x6743;&#x4E86;&#x6240;&#x6709;&#x7684;&#x6743;&#x9650;.<br>&#x5982;&#x679C;targetSdkVersion&#x5C0F;&#x4E8E;23,&#x5373;&#x88AB;&#x8BA4;&#x4E3A;&#x662F;Android 6.0&#x53D1;&#x5E03;&#x4E4B;&#x524D;&#x5F00;&#x53D1;&#x7684;&#x5E94;&#x7528;, &#x8FD8;&#x6CA1;&#x6709;&#x517C;&#x5BB9;6.0.<br>&#x8FD9;&#x79CD;&#x5E94;&#x7528;&#x5373;&#x4FBF;&#x662F;&#x88AB;&#x88C5;&#x5728;Android 6.0&#x7684;&#x673A;&#x5668;&#x4E0A;,&#x4E5F;&#x662F;&#x91C7;&#x7528;&#x539F;&#x6765;&#x7684;&#x5B89;&#x88C5;&#x5373;&#x6388;&#x4E88;&#x6743;&#x9650;&#x903B;&#x8F91;, &#x6240;&#x6709;&#x6743;&#x9650;&#x5728;&#x5E94;&#x7528;&#x5B89;&#x88C5;&#x65F6;&#x5168;&#x90E8;&#x88AB;&#x6388;&#x6743;.<br>&#x5728;Android 6.0&#x7684;&#x8BBE;&#x5907;&#x4E0A;&#x5B89;&#x88C5;targetSdkVersion&#x5C0F;&#x4E8E;23&#x7684;&#x5E94;&#x7528;&#x4E4B;&#x540E;, &#x53EF;&#x4EE5;&#x5728;&#x5E94;&#x7528;&#x7684;&#x8BBE;&#x7F6E;&#x4E2D;&#x67E5;&#x770B;,&#x53D1;&#x73B0;&#x6240;&#x6709;&#x7684;dangerous&#x6743;&#x9650;&#x72B6;&#x6001;&#x90FD;&#x662F;&#x6253;&#x5F00;.<br>&#x4F46;&#x662F;&#x7528;&#x6237;&#x4ECD;&#x7136;&#x53EF;&#x4EE5;&#x5728;&#x7CFB;&#x7EDF;&#x8BBE;&#x7F6E;&#x4E2D;&#x7981;&#x7528;&#x6743;&#x9650;</p>
<p>&#x56E0;&#x4E3A;&#x6743;&#x9650;&#x52A8;&#x6001;&#x68C0;&#x67E5;&#x76F8;&#x5173;&#x7684;API&#x662F;Android 6.0&#x624D;&#x52A0;&#x5165;&#x7684;, &#x6240;&#x4EE5;minSdkVersion&#x4E0D;&#x662F;23&#x65F6;,&#x63A8;&#x8350;&#x4F7F;&#x7528;SupportLibrary&#x6765;&#x5B9E;&#x73B0;,&#x597D;&#x5904;&#x662F;: &#x7A0B;&#x5E8F;&#x91CC;&#x4E0D;&#x5FC5;&#x52A0;if&#x6765;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x8BBE;&#x5907;&#x7684;&#x7248;&#x672C;.support&#x7684;&#x5305;&#x5FC5;&#x987B;&#x662F;23&#x4EE5;&#x4E0A;&#x624D;&#x53EF;&#x4EE5;.</p>
<p>&#x4E0B;&#x9762;&#x6765;&#x8BB2;&#x8BB2;&#x4EE3;&#x7801;&#x4E2D;&#x5982;&#x4F55;&#x9002;&#x914D;&#x8FD9;&#x79CD;&#x65B0;&#x7684;&#x6743;&#x9650;&#x673A;&#x5236;&#xFF1A;</p>
<h3 id="1-&#x68C0;&#x67E5;&#x6743;&#x9650;&#x72B6;&#x6001;"><a href="#1-&#x68C0;&#x67E5;&#x6743;&#x9650;&#x72B6;&#x6001;" class="headerlink" title="1.&#x68C0;&#x67E5;&#x6743;&#x9650;&#x72B6;&#x6001;"></a>1.&#x68C0;&#x67E5;&#x6743;&#x9650;&#x72B6;&#x6001;</h3><p>&#x5982;&#x679C;&#x5728;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x9700;&#x8981;&#x4E00;&#x4E2A;dangerous permission&#xFF0C;&#x90A3;&#x4E48;&#x6BCF;&#x6B21;&#x6267;&#x884C;&#x64CD;&#x4F5C;&#x90FD;&#x5FC5;&#x987B;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x6709;&#x8FD9;&#x4E2A;&#x6743;&#x9650;&#xFF0C;&#x56E0;&#x4E3A;&#x7528;&#x6237;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#x66F4;&#x6539;&#x6388;&#x6743;&#xFF0C;&#x6240;&#x4EE5;&#x5FC5;&#x987B;&#x6BCF;&#x6B21;&#x90FD;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x9009;&#x62E9;&#x7167;&#x7247;&#x5C31;&#x9700;&#x8981;&#x52A0;&#x5982;&#x4E0B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(PackageManager.PERMISSION_GRANTED == ContextCompat.checkSelfPermission(getActivity(), Manifest.permission.READ_EXTERNAL_STORAGE)){</div><div class="line">goImageSelect();</div><div class="line">}<span class="keyword">else</span>{</div><div class="line"><span class="comment">//do not have permission</span></div><div class="line">}</div></pre></td></tr></table></figure></p>
<h3 id="2-&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;"><a href="#2-&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;" class="headerlink" title="2.&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;"></a>2.&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;</h3><p>&#x5982;&#x679C;&#x4E0A;&#x9762;&#x7684;&#x5224;&#x65AD;&#x6CA1;&#x6709;&#x6743;&#x9650;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x9700;&#x8981;&#x663E;&#x5F0F;&#x7684;&#x8BF7;&#x6C42;&#x8FD9;&#x4E2A;&#x6743;&#x9650;&#xFF0C;Android&#x63D0;&#x4F9B;&#x4E86;&#x65B9;&#x6CD5;&#x6765;&#x52A8;&#x6001;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#xFF0C;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x65B9;&#x6CD5;&#x4F1A;&#x5F39;&#x51FA;&#x6807;&#x51C6;&#x7684;dialog&#xFF0C;&#x76EE;&#x524D;&#x8FD9;&#x4E2A;dialog&#x4E0D;&#x80FD;&#x88AB;&#x5B9A;&#x5236;&#x3002;</p>
<h4 id="2-1&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x6743;&#x9650;"><a href="#2-1&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x6743;&#x9650;" class="headerlink" title="2.1&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x6743;&#x9650;"></a>2.1&#x6709;&#x65F6;&#x5019;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x4E3A;&#x4EC0;&#x4E48;&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x6743;&#x9650;</h4><p>&#x4E00;&#x79CD;&#x65B9;&#x5F0F;&#x662F;,&#x5F53;&#x7528;&#x6237;&#x62D2;&#x7EDD;&#x8FC7;&#x8FD9;&#x4E2A;&#x6743;&#x9650;,&#x4F46;&#x662F;&#x53C8;&#x7528;&#x5230;&#x4E86;&#x8FD9;&#x4E2A;&#x529F;&#x80FD;, &#x90A3;&#x4E48;&#x5F88;&#x53EF;&#x80FD;&#x7528;&#x6237;&#x4E0D;&#x662F;&#x5F88;&#x660E;&#x767D;&#x4E3A;&#x4EC0;&#x4E48;app&#x9700;&#x8981;&#x8FD9;&#x4E2A;&#x6743;&#x9650;, &#x8FD9;&#x65F6;&#x5019;&#x5C31;&#x53EF;&#x4EE5;&#x5148;&#x5411;&#x7528;&#x6237;&#x89E3;&#x91CA;&#x4E00;&#x4E0B;.<br>&#x4E3A;&#x4E86;&#x53D1;&#x73B0;&#x8FD9;&#x79CD;&#x7528;&#x6237;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x89E3;&#x91CA;&#x7684;&#x60C5;&#x5F62;, Android&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5DE5;&#x5177;&#x7C7B;&#x65B9;&#x6CD5;: shouldShowRequestPermissionRationale()<br>&#x5982;&#x679C;app&#x4E4B;&#x524D;&#x8BF7;&#x6C42;&#x8FC7;&#x8BE5;&#x6743;&#x9650;,&#x88AB;&#x7528;&#x6237;&#x62D2;&#x7EDD;, &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x5C31;&#x4F1A;&#x8FD4;&#x56DE;true.<br>&#x5982;&#x679C;&#x7528;&#x6237;&#x4E4B;&#x524D;&#x62D2;&#x7EDD;&#x6743;&#x9650;&#x7684;&#x65F6;&#x5019;&#x52FE;&#x9009;&#x4E86;&#x5BF9;&#x8BDD;&#x6846;&#x4E2D;&#x201D;Don&#x2019;t ask again&#x201D;&#x7684;&#x9009;&#x9879;,&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x8FD4;&#x56DE;false.<br>&#x5982;&#x679C;&#x8BBE;&#x5907;&#x7B56;&#x7565;&#x7981;&#x6B62;&#x5E94;&#x7528;&#x62E5;&#x6709;&#x8FD9;&#x6761;&#x6743;&#x9650;, &#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4E5F;&#x8FD4;&#x56DE;false.<br>&#x5177;&#x4F53;&#x89E3;&#x91CA;&#x539F;&#x56E0;&#x7684;&#x8FD9;&#x4E2A;dialog&#x9700;&#x8981;&#x81EA;&#x5DF1;&#x5B9E;&#x73B0;, &#x7CFB;&#x7EDF;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//do not have permission</span></div><div class="line"><span class="comment">// Should we show an explanation?</span></div><div class="line"><span class="keyword">if</span> (ActivityCompat.shouldShowRequestPermissionRationale(MainActivity.<span class="keyword">this</span>,</div><div class="line">            Manifest.permission.READ_CONTACTS)) {</div><div class="line"></div><div class="line">        <span class="comment">// Show an explanation to the user *asynchronously* -- don&apos;t block</span></div><div class="line">        <span class="comment">// this thread waiting for the user&apos;s response! After the user</span></div><div class="line">        <span class="comment">// sees the explanation, try again to request the permission.</span></div><div class="line">        Log.i(DEBUG_TAG, <span class="string">&quot;we should explain why we need this permission!&quot;</span>);</div><div class="line">    } <span class="keyword">else</span> {</div><div class="line"></div><div class="line">        <span class="comment">// No explanation needed, we can request the permission.</span></div><div class="line">   }</div></pre></td></tr></table></figure>
<h4 id="2-2&#x8BF7;&#x6C42;&#x6743;&#x9650;"><a href="#2-2&#x8BF7;&#x6C42;&#x6743;&#x9650;" class="headerlink" title="2.2&#x8BF7;&#x6C42;&#x6743;&#x9650;"></a>2.2&#x8BF7;&#x6C42;&#x6743;&#x9650;</h4><p>&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x65B9;&#x6CD5;&#x5206;&#x4E24;&#x79CD;<br>&#x4E00;&#x79CD;&#x662F;&#x5728;Activity&#x91CC;&#x9762;&#x8BF7;&#x6C42;&#x4F7F;&#x7528;&#x5982;&#x4E0B;&#x65B9;&#x6CD5;<br>requestPermissions(final @NonNull Activity activity,<br>            final @NonNull String[] permissions, final int requestCode)<br>&#x4F20;&#x5165;&#x4E00;&#x4E2A;Activity, &#x4E00;&#x4E2A;permission&#x540D;&#x5B57;&#x7684;&#x6570;&#x7EC4;, &#x548C;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x7684;request code.<br>&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x662F;&#x5F02;&#x6B65;&#x7684;,&#x5B83;&#x4F1A;&#x7ACB;&#x5373;&#x8FD4;&#x56DE;, &#x5F53;&#x7528;&#x6237;&#x548C;dialog&#x4EA4;&#x4E92;&#x5B8C;&#x6210;&#x4E4B;&#x540E;,&#x7CFB;&#x7EDF;&#x4F1A;&#x8C03;&#x7528;&#x56DE;&#x8C03;&#x65B9;&#x6CD5;,&#x4F20;&#x56DE;&#x7528;&#x6237;&#x7684;&#x9009;&#x62E9;&#x7ED3;&#x679C;&#x548C;&#x5BF9;&#x5E94;&#x7684;request code.<br>&#x793A;&#x4F8B;&#x4EE3;&#x7801;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ActivityCompat.requestPermissions(CreateMeetActivity.<span class="keyword">this</span>,<span class="keyword">new</span> String[]{Manifest.permission.READ_EXTERNAL_STORAGE}, PermissionCode.MY_PERMISSIONS_REQUEST_READ_EXTERNAL_STORAGE);</div></pre></td></tr></table></figure></p>
<p>&#x4E00;&#x79CD;&#x662F;&#x5728;Fragment&#x91CC;&#x9762;&#x8BF7;&#x6C42;<br>requestPermissions(@NonNull String[] permissions, int requestCode)<br>&#x5C11;&#x4E00;&#x4E2A;Activity&#x53C2;&#x6570;&#xFF0C;&#x5176;&#x4ED6;&#x4E00;&#x6837;&#xFF0C;&#x4F46;&#x662F;&#x56DE;&#x8C03;&#x9700;&#x8981;&#x7279;&#x522B;&#x8BF4;&#x660E;&#xFF0C;&#x8FD8;&#x6709;fragment&#x5D4C;&#x5957;fragment&#x7684;&#x56DE;&#x8C03;&#x5904;&#x7406;&#x60C5;&#x51B5;&#xFF0C;&#x4E0B;&#x9762;&#x4F1A;&#x5355;&#x72EC;&#x8BF4;&#x660E;&#x3002;</p>
<h4 id="2-3&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x54CD;&#x5E94;"><a href="#2-3&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x54CD;&#x5E94;" class="headerlink" title="2.3&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x54CD;&#x5E94;"></a>2.3&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;&#x54CD;&#x5E94;</h4><p>&#x5F53;&#x7528;&#x6237;&#x5BF9;&#x8BF7;&#x6C42;&#x6743;&#x9650;&#x7684;dialog&#x505A;&#x51FA;&#x54CD;&#x5E94;&#x4E4B;&#x540E;,&#x7CFB;&#x7EDF;&#x4F1A;&#x8C03;&#x7528;onRequestPermissionsResult() &#x65B9;&#x6CD5;,&#x4F20;&#x56DE;&#x7528;&#x6237;&#x7684;&#x9009;&#x62E9;&#x7ED3;&#x679C;&#x548C;request code.<br>&#x8FD9;&#x4E2A;&#x56DE;&#x8C03;&#x4E2D;request code&#x5373;&#x4E3A;&#x8C03;&#x7528;requestPermissions()&#x65F6;&#x4F20;&#x5165;&#x7684;&#x53C2;&#x6570;,&#x662F;app&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x4E00;&#x4E2A;&#x6574;&#x578B;&#x503C;.<br>&#x5982;&#x679C;&#x8BF7;&#x6C42;&#x53D6;&#x6D88;,&#x8FD4;&#x56DE;&#x7684;&#x6570;&#x7EC4;&#x5C06;&#x4F1A;&#x4E3A;&#x7A7A;.<br>&#x4EE3;&#x7801;&#x5982;&#x4E0B;&#xFF1A;<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode, @NonNull String[] permissions, @NonNull <span class="keyword">int</span>[] grantResults)</span> </span>{</div><div class="line">        <span class="keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</div><div class="line">        <span class="keyword">switch</span> (requestCode) {</div><div class="line">            <span class="keyword">case</span> PermissionCode.MY_PERMISSIONS_REQUEST_READ_EXTERNAL_STORAGE: {</div><div class="line">                <span class="comment">// If request is cancelled, the result arrays are empty.</span></div><div class="line">                <span class="keyword">if</span> (grantResults.length &gt; <span class="number">0</span>&amp;&amp; grantResults[<span class="number">0</span>] == PackageManager.PERMISSION_GRANTED) {</div><div class="line"></div><div class="line">                    <span class="comment">// permission was granted, yay! Do the</span></div><div class="line">                    <span class="comment">// contacts-related task you need to do.</span></div><div class="line">                    goFileSelect();</div><div class="line">                    Log.i(TAG, <span class="string">&quot;user granted the permission!&quot;</span>);</div><div class="line"></div><div class="line">                } <span class="keyword">else</span> {</div><div class="line"></div><div class="line">                    <span class="comment">// permission denied, boo! Disable the</span></div><div class="line">                    <span class="comment">// functionality that depends on this permission.</span></div><div class="line">                    Log.i(TAG, <span class="string">&quot;user denied the permission!&quot;</span>);</div><div class="line">                }</div><div class="line">                <span class="keyword">return</span>;</div><div class="line">            }</div><div class="line"></div><div class="line">            <span class="comment">// other &apos;case&apos; lines to check for other</span></div><div class="line">            <span class="comment">// permissions this app might request</span></div><div class="line">        }</div></pre></td></tr></table></figure></p>
<p>&#x5728;Fragment&#x4E2D;&#x7533;&#x8BF7;&#x6743;&#x9650;&#xFF0C;&#x4E0D;&#x8981;&#x4F7F;&#x7528;ActivityCompat.requestPermissions, &#x76F4;&#x63A5;&#x4F7F;&#x7528;Fragment&#x7684;requestPermissions&#x65B9;&#x6CD5;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x56DE;&#x8C03;&#x5230;Activity&#x7684; onRequestPermissionsResult<br>&#x5982;&#x679C;&#x5728;Fragment&#x4E2D;&#x5D4C;&#x5957;Fragment&#xFF0C;&#x5728;&#x5B50;Fragment&#x4E2D;&#x4F7F;&#x7528;requestPermissions&#x65B9; &#x6CD5;&#xFF0C;onRequestPermissionsResult&#x4E0D;&#x4F1A;&#x56DE;&#x8C03;&#x56DE;&#x6765;&#xFF0C;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528; getParentFragment().requestPermissions&#x65B9;&#x6CD5;&#xFF0C;&#x8FD9;&#x4E2A;&#x65B9;&#x6CD5;&#x4F1A;&#x56DE;&#x8C03;&#x5230;&#x7236;Fragment&#x4E2D;&#x7684;onRequestPermissionsResult&#xFF0C;&#x52A0;&#x5165;&#x4EE5;&#x4E0B;&#x4EE3;&#x7801;&#x53EF;&#x4EE5;&#x628A;&#x56DE;&#x8C03;&#x900F;&#x4F20;&#x5230;&#x5B50;Fragment</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRequestPermissionsResult</span><span class="params">(<span class="keyword">int</span> requestCode, String[] permissions, <span class="keyword">int</span>[] grantResults)</span> </span>{</div><div class="line">      <span class="keyword">super</span>.onRequestPermissionsResult(requestCode, permissions, grantResults);</div><div class="line">      List&lt;Fragment&gt; fragments = getChildFragmentManager().getFragments();</div><div class="line">      <span class="keyword">if</span> (fragments != <span class="keyword">null</span>) {</div><div class="line">          <span class="keyword">for</span> (Fragment fragment : fragments) {</div><div class="line">              <span class="keyword">if</span> (fragment != <span class="keyword">null</span>) {</div><div class="line">                  fragment.onRequestPermissionsResult(requestCode,permissions,grantResults);</div><div class="line">              }</div><div class="line">          }</div><div class="line">      }</div><div class="line">  }</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/08/08/2016-8-8/" itemprop="url">
                  如何使用markdown插入图片
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-08-08T10:37:51+08:00" content="2016-08-08">
              2016-08-08
            </time>
          </span>

          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/08/08/2016-8-8/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/08/08/2016-8-8/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2016/08/08/2016-8-8/" class="leancloud_visitors" data-flag-title="如何使用markdown插入图片">
               &nbsp; | &nbsp;
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>&#x7531;&#x4E8E;&#x5BF9;markdown&#x8BED;&#x6CD5;&#x4E0D;&#x662F;&#x5F88;&#x719F;&#xFF0C;&#x4E0A;&#x7BC7;&#x535A;&#x5BA2;&#x90FD;&#x6CA1;&#x6709;&#x63D2;&#x56FE;&#xFF0C;&#x4ECA;&#x5929;&#x7814;&#x7A76;&#x4E86;&#x4E0B;&#x5728;&#x4E0A;&#x7BC7;&#x535A;&#x5BA2;&#x8865;&#x4E86;&#x4E24;&#x5F20;&#x56FE;&#x3002;&#x4E0B;&#x9762;&#x8BB0;&#x5F55;&#x4E0B;&#xFF0C;&#x600E;&#x4E48;&#x63D2;&#x5165;&#x56FE;&#x7247;&#xFF1A;</p>
<h3 id="1-&#x9996;&#x5148;&#x786E;&#x8BA4;-config-yml-&#x4E2D;&#x6709;-post-asset-folder-true"><a href="#1-&#x9996;&#x5148;&#x786E;&#x8BA4;-config-yml-&#x4E2D;&#x6709;-post-asset-folder-true" class="headerlink" title="1.&#x9996;&#x5148;&#x786E;&#x8BA4;_config.yml &#x4E2D;&#x6709; post_asset_folder:true"></a>1.&#x9996;&#x5148;&#x786E;&#x8BA4;_config.yml &#x4E2D;&#x6709; post_asset_folder:true</h3><p>&#x7136;&#x540E;&#x6267;&#x884C;&#x5982;&#x4E0B;&#x547D;&#x4EE4;&#x4E0B;&#x8F7D;hexo&#x56FE;&#x7247;&#x63D2;&#x4EF6;<br><code>npm install https://github.com/CodeFalling/hexo-asset-image --save</code></p>
<h3 id="2-&#x5728;md&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x548C;md&#x540C;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5982;&#xFF1A;"><a href="#2-&#x5728;md&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x548C;md&#x540C;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5982;&#xFF1A;" class="headerlink" title="2.&#x5728;md&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x548C;md&#x540C;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5982;&#xFF1A;"></a>2.&#x5728;md&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x548C;md&#x540C;&#x540D;&#x7684;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5982;&#xFF1A;</h3><p>2016-08-05<br>&#x251C;&#x2500;&#x2500; xxx.png<br>&#x2514;&#x2500;&#x2500; xxxx.png<br>2016-08-05.md</p>
<p><img src="/2016/08/08/2016-8-8/catalog.jpg" alt="catalog"></p>
<p>&#x7136;&#x540E;&#x4F7F;&#x7528;<code>![xxx](2016-08-05/xxx.png)</code>&#x5C31;&#x53EF;&#x63D2;&#x5165;&#x56FE;&#x7247;</p>
<h1 id="&#x6CE8;&#x610F;&#x5982;&#x679C;&#x662F;&#x5148;&#x4E0B;&#x8F7D;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x5F53;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x521B;&#x5EFA;md&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x5939;&#x7528;&#x6765;&#x5B58;&#x653E;&#x56FE;&#x7247;"><a href="#&#x6CE8;&#x610F;&#x5982;&#x679C;&#x662F;&#x5148;&#x4E0B;&#x8F7D;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x5F53;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x521B;&#x5EFA;md&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x5939;&#x7528;&#x6765;&#x5B58;&#x653E;&#x56FE;&#x7247;" class="headerlink" title="&#x6CE8;&#x610F;&#x5982;&#x679C;&#x662F;&#x5148;&#x4E0B;&#x8F7D;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x5F53;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x521B;&#x5EFA;md&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x5939;&#x7528;&#x6765;&#x5B58;&#x653E;&#x56FE;&#x7247;"></a>&#x6CE8;&#x610F;&#x5982;&#x679C;&#x662F;&#x5148;&#x4E0B;&#x8F7D;&#x7684;&#x63D2;&#x4EF6;&#xFF0C;&#x5F53;&#x6267;&#x884C;&#x547D;&#x4EE4;&#x521B;&#x5EFA;md&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x521B;&#x5EFA;&#x540C;&#x540D;&#x6587;&#x4EF6;&#x5939;&#x7528;&#x6765;&#x5B58;&#x653E;&#x56FE;&#x7247;</h1><p>&#x751F;&#x6210;&#x7684;&#x7ED3;&#x6784;&#x4E3A;<br>public/2016/08/05/2016-08-05<br>&#x251C;&#x2500;&#x2500; xxx.png<br>&#x2514;&#x2500;&#x2500; xxxx.png</p>
<p>&#x751F;&#x6210;&#x7684; html &#x662F;</p>
<p><code>&lt;img src=&quot;/2016/08/05/2016-08-05/xxx.png&quot; alt=&quot;xxx&quot;&gt;</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="Dino" />
          <p class="site-author-name" itemprop="name">Dino</p>
          <p class="site-description motion-element" itemprop="description">Life is made up of small pleasures.</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">16</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">5</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/dinomonster" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.facebook.com/profile.php?id=100006608145650&fref=ts" target="_blank" title="Facebook">
                  
                    <i class="fa fa-fw fa-facebook"></i>
                  
                  Facebook
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Dino</span>
</div>

<!--
<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>


<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>
-->

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"dinomonster"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = true;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = data.url;
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '' && data_content != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title < 0 && index_content < 0 ){
                                isMatch = false;
                            } else {
                                if (index_content < 0) {
                                    index_content = 0;
                                }
                                if (i == 0) {
                                    first_occur = index_content;
                                }
                            }
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("8qm7vzCs0YAgf2tnqzt4ODts-gzGzoHsz", "FHqdtTG6DkUcj659EdD0LHd4");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

</body>
</html>
